<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="author" content="wly">
<meta name="keywords" content="R语言, 数学运算, wly的博客, supernum">
<meta name="description" content="R语言作为一门专为统计分析诞生的语言，数学运算自然是必不可少的。这篇文章将介绍R语言是如何对数组进行数学运算的。">


  
    <meta property="article:published_time" content="2019-04-10T00:00:00">
  
  
    <meta property="article:modified_time" content="2019-04-14T00:00:00">
  
  
  
    
      <meta property="article:section" content="R语言">
    
      <meta property="article:section" content="数学运算">
    
  
  
    
      <meta property="article:tag" content="R语言数学运算">
    
  



<meta property="og:locale" content="zh-cn">
<meta property="og:site_name" content="wly&#39;s notebook">
<meta property="og:url" content="/2019/04/%E4%BD%BF%E7%94%A8r%E8%AF%AD%E8%A8%80%E5%AF%B9%E6%95%B0%E7%BB%84%E8%BF%9B%E8%A1%8C%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97/">
<meta property="og:type" content="article">
<meta property="og:title" content="使用R语言对数组进行数学运算">
<meta property="og:description" content="R语言作为一门专为统计分析诞生的语言，数学运算自然是必不可少的。这篇文章将介绍R语言是如何对数组进行数学运算的。">


  <meta property="og:image" content="https://s2.ax1x.com/2019/08/04/eyNAu4.png">





  <meta property="og:image" content="https://s2.ax1x.com/2019/10/19/KmV65q.png">


    <title>使用R语言对数组进行数学运算</title>

    <link rel="canonical" href="../../../2019/04/%E4%BD%BF%E7%94%A8r%E8%AF%AD%E8%A8%80%E5%AF%B9%E6%95%B0%E7%BB%84%E8%BF%9B%E8%A1%8C%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97/">
    <link rel="icon" href="../../../img/favicon.ico">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="../../../">

    
    
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/jquery.fancybox.min.css" />
    <link rel="stylesheet" href="../../../css/jquery.fancybox-thumbs.min.css" />
    <link rel="stylesheet" href="../../../highlight/styles/github.css">
    
    <link rel="stylesheet" href="../../../css/style-nnm2spxvve8onlujjlegkkytaehyadd4ksxc1hyzzq9a2wvtrgbljqyulomn.min.css" />
    
    

    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="../../../">wly&#39;s notebook</a>
  </div>
  
    
      <a class="header-right-picture "
         href="../../../#about">
    
    
    
      
        <img class="header-picture" src="https://s2.ax1x.com/2019/10/19/KmV65q.png" alt="作者的图片" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    <div class="sidebar-profile">
      <a href="../../../#about">
        <img class="sidebar-profile-picture" src="https://s2.ax1x.com/2019/10/19/KmV65q.png" alt="作者的图片" />
      </a>
      <h4 class="sidebar-profile-name">wly</h4>
      
        <h5 class="sidebar-profile-bio">仍是年少不知愁</h5>
      
      
        <h5 class="sidebar-profile-bio" style="margin-top: 0">Still young. Still alive</h5>
      
    </div>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="../../../">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">首页</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="../../../categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">分类</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="../../../tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">标签</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="../../../archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">归档</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="../../../page/about">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">关于</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/supernum163" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="mailto:supernum@163.com" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-at"></i>
      
      <span class="sidebar-button-desc">Email</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="../../../page/donate">
    
      <i class="sidebar-button-icon fa fa-lg fa-rmb"></i>
      
      <span class="sidebar-button-desc">打赏</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="../../../index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title" itemprop="headline">
      使用R语言对数组进行数学运算
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="publishDate" datetime="2019-04-10T00:00:00Z">
        
  
  
  
  
    2019-04-10
  

      </time>
    
    
  
  
    <span>发布在</span>
    
      <a class="category-link" href="../../../categories/r%e8%af%ad%e8%a8%80">R语言</a>, 
    
      <a class="category-link" href="../../../categories/%e6%95%b0%e5%ad%a6%e8%bf%90%e7%ae%97">数学运算</a>
    
  

    
      <span>&emsp;更新于</span>
      <time itemprop="lastmod" datetime="2019-04-14T00:00:00Z">
        2019-04-14
      </time>
    
  </div>

</div>
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              <p><strong>R语言</strong>作为一门专为统计分析诞生的语言，数学运算自然是必不可少的。这篇文章将介绍R语言是如何对<strong>数组</strong>进行数学运算的。</p>

<h1 id="table-of-contents">目录</h1><nav id="TableOfContents">
<ul>
<li><a href="#1-什么是数组">1、什么是数组</a></li>
<li><a href="#2-数组的生成与运用">2、数组的生成与运用</a>
<ul>
<li><a href="#2-1-生成数组">2.1、生成数组</a></li>
<li><a href="#2-2-取数组下标-长度">2.2、取数组下标、长度</a></li>
<li><a href="#2-3-数组合并-取子集">2.3、数组合并、取子集</a></li>
<li><a href="#2-4-重复-去重数组元素">2.4、重复、去重数组元素</a></li>
<li><a href="#2-5-集合的交并补">2.5、集合的交并补</a></li>
<li><a href="#2-6-数组排序">2.6、数组排序</a></li>
<li><a href="#2-7-获取数组中特定元素的位置-下标">2.7、获取数组中特定元素的位置（下标）</a></li>
</ul></li>
<li><a href="#3-数组的基本数学运算">3、数组的基本数学运算</a></li>
<li><a href="#4-数组特征值">4、数组特征值</a>
<ul>
<li><a href="#4-1-最大-最小值">4.1、最大、最小值</a></li>
<li><a href="#4-2-平均值与分位数">4.2、平均值与分位数</a></li>
<li><a href="#4-3-计算数组离散程度">4.3、计算数组离散程度</a></li>
</ul></li>
<li><a href="#5-时间序列类型的数组">5、时间序列类型的数组</a>
<ul>
<li><a href="#5-1-时滞-前导与差分">5.1、时滞、前导与差分</a></li>
<li><a href="#5-2-时间序列的累计算法">5.2、时间序列的累计算法</a></li>
<li><a href="#5-3-时间序列的ar-ma式累计">5.3、时间序列的AR、MA式累计</a></li>
<li><a href="#5-4-设置取值上-下限">5.4、设置取值上、下限</a></li>
</ul></li>
<li><a href="#6-结语">6、结语</a></li>
</ul>
</nav>

<p><br></p>

<h1 id="1-什么是数组">1、什么是数组</h1>

<p>在R语言中我们经常会使用到<strong>vector</strong>类型的变量，这种类型的数据结构，与<strong>C语言</strong>中的数组类似，都是由相同数据类型的<strong>元素</strong>组成的集合。我们可以使用<strong>数组下标</strong>访问到数组中的某一个元素（注意R语言中的数组下标是从1开始的）。数组可以由数字类型的元素构成，也可以由其它类型的元素构成（如字符、逻辑值等），以下涉及到数学运算的部分，我们将只探讨由数字组成的数组。</p>

<p><br></p>

<h1 id="2-数组的生成与运用">2、数组的生成与运用</h1>

<h2 id="2-1-生成数组">2.1、生成数组</h2>

<p>在R语言中我们可以使用<span class="highlight-text primary">c</span>函数生成数组，如下所示，我们生成了一个由1到10的整数组成的数组。</p>

<pre><code class="language-R">&gt; c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)
[1]  1  2  3  4  5  6  7  8  9 10
</code></pre>

<p>有时我们需要生成一个按规律递增或递减（一阶导数为常数）的数列，这时<span class="highlight-text primary">seq</span>函数就非常有用了。<strong>seq</strong>函数的使用方式如下：</p>

<p><code>seq(from = 1, to = 1, by = ((to - from)/(length.out - 1)), length.out = NULL, along.with = NULL, ...)</code></p>

<ul>
<li><strong>from、to</strong>即需要生成的数组的起始值与终止值</li>
<li>有时我们需要生成的数组以<strong>n</strong>递增，则可以指定递增值<code>by = n</code></li>
<li>有时候我们不关心递增值，只想生成<strong>n</strong>个数字，则可以指定<code>length.out = n</code></li>
<li>有时我们需要生成一个与数组<strong>x</strong>等长的新数组，则可以指定<code>along.with = x</code></li>
</ul>

<p>注意<strong>by、length.out、along.with</strong>只需要指定一个。</p>

<pre><code class="language-R">&gt; seq(1, 10, by = 1)
[1]  1  2  3  4  5  6  7  8  9 10
&gt; seq(1, 10, length.out = 10)
[1]  1  2  3  4  5  6  7  8  9 10
&gt; seq(1, 10, along.with = 1:10)
[1]  1  2  3  4  5  6  7  8  9 10
</code></pre>

<p>此外，R语言中还定义了一些便捷函数，它们的功能都可以使用<strong>seq</strong>实现。比如:</p>

<ul>
<li><code>n:m</code>相当于<code>seq(n, m, by = 1)</code>（当<code>n &gt; m</code>时，<code>by = -1</code>）</li>
<li><code>seq_len(n)</code>相当于<code>seq(1, n, by = 1)</code></li>
</ul>

<p><br></p>

<h2 id="2-2-取数组下标-长度">2.2、取数组下标、长度</h2>

<p>对于特定数组<strong>x</strong>，当我们需要知道<strong>x</strong>的数组下标或者长度时，可以分别使用<span class="highlight-text primary">seq_along</span>、<span class="highlight-text primary">length</span>函数来完成。注意<code>seq_along(x)</code>相当于<code>1:length(x)</code></p>

<pre><code class="language-R">&gt; x &lt;- seq(1, 10, by = 1)
&gt; seq_along(x)
[1]  1  2  3  4  5  6  7  8  9 10
&gt; length(x)
[1]  10
</code></pre>

<p><br></p>

<h2 id="2-3-数组合并-取子集">2.3、数组合并、取子集</h2>

<p>对于两个数组<strong>x、y</strong>，如果需要将它们合并为一个数组，则可以使用命令<code>c(x, y)</code>，注意这里的数组生成函数<strong>c</strong>的最终运行结果会将两个数组中的元素合并到一个数组中，而不是生成一个数组包含两个元素，分别对应数组<strong>x、y</strong>。如果我们真的需要按照第二种方式合并<strong>x、y</strong>，则需要使用函数<span class="highlight-text primary">list</span>。</p>

<pre><code class="language-R">&gt; x &lt;- 1:5; y &lt;- 6:10
&gt; c(x, y)
[1]  1  2  3  4  5  6  7  8  9 10
</code></pre>

<p>有时我们只需要使用到数组的部分元素，那么我们可以通过操作符<span class="highlight-text primary">[]</span>使用数组下标来筛选出这部分元素。有时我们不关心数组下标，而只想从数组中筛选符合某个条件的元素（比如筛选出数组中所有小于5的元素），则可以使用命令<span class="highlight-text primary">subset(x, subset)</span>。<strong>subset</strong>本质上调用了<strong>[]</strong>操作符，不同的是前者会忽略缺失值<strong>NA</strong>，而后者则不会。</p>

<pre><code class="language-R">&gt; x &lt;- c(10:1, NA)
&gt; x[c(1, 3, 5)]
[1] 10  8  6
&gt; x[x &lt; 5]
[1]  4  3  2  1 NA
&gt; subset(x, x &lt; 5)
[1] 4 3 2 1
</code></pre>

<p><br></p>

<h2 id="2-4-重复-去重数组元素">2.4、重复、去重数组元素</h2>

<p>有时我们需要生成一个元素按规律重复的数组，那么<span class="highlight-text primary">rep</span>函数就非常实用了。<strong>rep</strong>函数的参数形式为：</p>

<p><code>rep(x, times = 1, length.out = NULL, each = NULL)</code></p>

<ul>
<li><strong>x</strong>即需要被重复的元素组成的数组</li>
<li>当我们指定<code>times = n</code>时，相当于将n个数组<strong>x</strong>合并</li>
<li>当我们指定<code>length.out = n</code>时，相当于取合并后的前n个元素</li>
<li>当我们指定<code>each = n</code>时，相当于将每一个元素重复n次</li>
</ul>

<p>注意<strong>times、length.out、each</strong>只需要指定一个。</p>

<pre><code class="language-R">&gt; rep(1:2, times = 3)
[1] 1 2 1 2 1 2
&gt; rep(1:2, length.out = 3)
[1] 1 2 1
&gt; rep(1:2, each = 3)
[1] 1 1 1 2 2 2
</code></pre>

<p>有时候我们需要去除数组中重复的数据，则可以直接使用<span class="highlight-text primary">unique</span>函数。当我们需要删除部分元素的重复数据，而保留另外部分元素的重复数据时，则可以在<strong>unique</strong>函数中使用<code>incomparables = x</code>（x为由需要保留的元素组成的数字或数组）的形式来指明那些元素的重复值需要被保留。有时我们需要从数组的右侧（或尾部）开始，取第一个不重复的元素，则可以指明<code>fromLast = TRUE</code>。</p>

<pre><code class="language-R">&gt; unique(rep(1:2, 3))
[1] 1 2
&gt; unique(rep(1:2, 3), incomparables = 1)
[1] 1 2 1 1
&gt; unique(rep(1:2, 3), incomparables = 1, fromLast = TRUE)
[1] 1 1 1 2
</code></pre>

<p>在R语言中，有一个与<strong>unique</strong>函数的使用方法几乎一致的函数<span class="highlight-text primary">duplicated</span>。两者的区别在于，<strong>unique</strong>函数在计算完重复之后，会直接按规则取出*不重复*的值，而<strong>duplicated</strong>`则会生成一个由逻辑值组成的数组，指示哪些元素会被取出，哪些元素不会。</p>

<p><br></p>

<h2 id="2-5-集合的交并补">2.5、集合的交并补</h2>

<p>在R语言中没有<strong>集合</strong>类型的数据类型，但我们可以用不含重复值的数组来表示集合。我们可以分别使用<span class="highlight-text primary">intersect、union、setdiff</span>函数，来求集合的<strong>交集、并集、差集或补集</strong>。此外我们还可以使用<span class="highlight-text primary">setequal</span>函数，来判断两个集合是否相同。</p>

<pre><code class="language-R">&gt; setdiff(3:5, 1:4)
[1] 5
&gt; union(1:2, 2:3)
[1] 1 2 3
&gt; intersect(1:2, 2:3)
[1] 2
&gt; setdiff(1:2, 2:3)
[1] 1
&gt; setequal(1:3, rep(1:3, 3))
[1] TRUE
</code></pre>

<p><br></p>

<h2 id="2-6-数组排序">2.6、数组排序</h2>

<p>有时候我们需要对特定的数组排序，则可以使用<span class="highlight-text primary">sort</span>函数（注意<strong>sort</strong>函数默认会从小到大排序，如果需要从大到小排序，则可以加上<code>decreasing = TRUE</code>）。如果我们不关心排序结果，而只想知道，排序后数组的每个元素会被放在新数组的什么位置，则可以使用<span class="highlight-text primary">order</span>函数，两者关系如下：<code>sort(x) = x[order(x)]</code>。 如果想知道数组中每个元素的排名（由小到大），则可以使用<span class="highlight-text primary">rank</span>函数，<strong>rank</strong>与<strong>sort</strong>的关系如下：<code>x = sort(x)[rank(x)]</code>。</p>

<pre><code class="language-R">&gt; sort(c(2.5, 4.5, 1.5, 3.5))
[1] 1.5 2.5 3.5 4.5
&gt; order(c(2.5, 4.5, 1.5, 3.5))
[1] 3 1 4 2
&gt; rank(c(2.5, 4.5, 1.5, 3.5))
[1] 2 4 1 3
</code></pre>

<p><br></p>

<h2 id="2-7-获取数组中特定元素的位置-下标">2.7、获取数组中特定元素的位置（下标）</h2>

<p>我们已经知道了如何 <a href="#2-3-数组合并-取子集">从数组中筛选出特定的元素</a>。但有些时候我们需要知道数组中特定元素的下标是什么，则可以使用命令<span class="highlight-text primary">which(expr)</span> （其中<strong>expr</strong>为<strong>条件表达式</strong>）。有时候哦我们不想使用条件表达式，只想知道特定元素<strong>n</strong>在数组<strong>x</strong>中的位置，则可以使用命令<span class="highlight-text primary">match(n, x)</span>。如果我们只是想知道数组<strong>x</strong>中是否包含元素<strong>n</strong>，则可以使用命令<span class="highlight-text primary">n %in% x</span>。</p>

<pre><code class="language-R">&gt; x &lt;- c(10:1, NA)
&gt; which(x &lt; 5)
[1]  7  8  9 10
&gt; match(5, x)
[1] 6
&gt; 5 %in% x
[1] TRUE
</code></pre>

<p><br></p>

<h1 id="3-数组的基本数学运算">3、数组的基本数学运算</h1>

<p>我们在 <a href="../../使用r语言对数字进行数学运算/#1-什么是数字类型的对象">上文</a>中介绍过，R语言会以数组的形式存储<strong>数字类型的对象</strong>。所以上文介绍的所有针对数字进行数学运算的方法，对于数组依然适用。不同的是：</p>

<ul>
<li>如果数组与数字进行数学运算，则相当于数组中的每个元素分别与这个数字进行运算</li>
<li>如果两个等长数组进行数学运算，则相当于按照数组下标分别对相应的元素进行运算</li>
<li>如果参与数学运算的两个数组长度不同，则相当于将短数组 <a href="#2-4-重复-去重数组元素">重复</a>至与长数组等长，再进行运算</li>
</ul>

<pre><code>&gt; 1:10 + 2
 [1]  3  4  5  6  7  8  9 10 11 12
&gt; 1:10 + 1:10
 [1]  2  4  6  8 10 12 14 16 18 20
&gt; 1:10 + 1:5
 [1]  2  4  6  8 10  7  9 11 13 15
&gt; 1:10 + rep(1:5, times = 2)
 [1]  2  4  6  8 10  7  9 11 13 15
</code></pre>

<p><br></p>

<h1 id="4-数组特征值">4、数组特征值</h1>

<p>对于一个数组，有时候我们并不关心数组中每个元素的具体值，而只想从这些元素中提取出一个值来描述这个数组的某些特征，这样的值就可以看作是数组的<strong>特征值</strong>。</p>

<p><br></p>

<h2 id="4-1-最大-最小值">4.1、最大、最小值</h2>

<p>我们可以通过<span class="highlight-text primary">max</span>、<span class="highlight-text primary">min</span>函数分别取得数组的<strong>最大值</strong>、<strong>最小值</strong>，如果我们需要知道数组的<strong>取值范围</strong>，则可以使用<span class="highlight-text primary">range</span>函数。注意缺失值<strong>NA</strong>不能参与数学运算，所以当数组中包含缺失值时，直接求最大或最小值最终结果都是<strong>NA</strong>，正确的做法是在函数中加入<code>na.rm = TRUE</code>（下不赘述）。</p>

<p><br></p>

<h2 id="4-2-平均值与分位数">4.2、平均值与分位数</h2>

<p>我们可以通过<span class="highlight-text primary">mean</span>、<span class="highlight-text primary">median</span>函数分别取得数组的<strong>平均值</strong>与<strong>中位数</strong>。如果我们需要求数组的<strong>任意分位数</strong>（1/4分位数、3/4分位数等），则可以使用命令<span class="highlight-text primary">quantile(x, probs)</span>。注意：<code>quantile(x, 0) = min(x)，quantile(x, 1) = max(x)</code></p>

<p>实际应用中我们会经常遇到<strong>特异值</strong>（在一个数组中某些值特别大或者特别小，导致计算平均数等特征值时严重脱离实际）。对于特定的数组<strong>x</strong>，如何判断其中那些元素是特异值呢？从统计学的角度来看，如果超出了2.5倍的四分位距就可以算作特异着。这个范围用R语言代码表示就是：<code>[2.5*quantile(x, 1/4) - 1.5*median(x), 2.5*quantile(x, 3/4) - 1.5*median(x)]</code></p>

<p>此外R语言中还定义了一些快捷函数，它们的功能都可以用<strong>quantile</strong>函数实现。比如计算<strong>四分位距</strong>的<span class="highlight-text primary">IQR</span>函数，计算数组五个特征值（最小值、1/4分位数、中位数、3/4分位数、最大值）的<span class="highlight-text primary">fivenum</span>函数。注意：<code>IQR(x) = quantile(x, 3/4) - quantile(x, 1/4)</code></p>

<p><br></p>

<h2 id="4-3-计算数组离散程度">4.3、计算数组离散程度</h2>

<p>对于一个长度为<strong>n</strong>的数组<strong>x</strong>，如果我们想知道数组中各元素的离散情况，则可以通过<span class="highlight-text primary">var</span>函数求数组的<strong>方差</strong>，或者通过<span class="highlight-text primary">sd</span>函数求数组的<strong>标准差</strong>。二者有以下关系：</p>

<p>$$var(x) = \frac {\sum_{i = 1}^n {(x_i - mean(x))^2}} {n - 1}, sd(x) = \sqrt {var(x)}$$</p>

<p>当然我们也可以通过其它方式计算数组的离散程度，比如通过<span class="highlight-text primary">mad</span>计算<strong>绝对中位差</strong>（与<strong>离差</strong>近似）：<code>mad(x) = median(abs(x - center)) * constant（默认情况下center = median(x), constant = 1.4826）</code></p>

<p><br></p>

<h1 id="5-时间序列类型的数组">5、时间序列类型的数组</h1>

<p>如果我们将一组拥有时间属性的元素，按照时间发生的先后顺序进行排列，最终生成的数组就可以被称作<strong>时间序列</strong>。比如R语言系统数据集中的<strong>co2</strong>数组就是一个时间序列，它记载了1959年至1997年间每个月份大气中二氧化碳的含量。</p>

<p>对于一个普通数组，我们可以通过命令<span class="highlight-text primary">ts</span>将其转化为一个时间序列：</p>

<p><code>ts(data, start = 1, end = numeric(), frequency = 1, deltat = 1)</code></p>

<ul>
<li><strong>data</strong>即需要被转化的数组</li>
<li><strong>start、end</strong>分别代表时间序列的起始与终止时刻</li>
<li><strong>frequency、deltat</strong>均可以表示时间序列的<strong>周期性</strong>，不同的是，前者表示一个周期内有多少条<strong>观测值</strong>，后者表示一个观测值在一个周期中占的比重</li>
</ul>

<pre><code class="language-R">&gt; ts(1:24, start = 2019, frequency = 12)
     Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
2019   1   2   3   4   5   6   7   8   9  10  11  12
2020  13  14  15  16  17  18  19  20  21  22  23  24
&gt; ts(1:24, end = c(2019, 12), deltat = 1/12)
     Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
2018   1   2   3   4   5   6   7   8   9  10  11  12
2019  13  14  15  16  17  18  19  20  21  22  23  24
</code></pre>

<p><br></p>

<h2 id="5-1-时滞-前导与差分">5.1、时滞、前导与差分</h2>

<p>对于一个时间序列，如果我们将其中的每个元素都按照时间向后推移<strong>n</strong>个位置，就可以得到该时间序列的<strong>n阶时滞</strong>。同理如果我们向前推移<strong>n</strong>个位置，就可以得到<strong>n阶前导</strong>，在R语言中这两种计算方式都可以通过<span class="highlight-text primary">lag</span>函数完成。</p>

<pre><code class="language-R">&gt; x &lt;- ts(1:24, end = c(2019, 12), deltat = 1/12)
&gt; lag(x, 1)
     Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
2017                                               1
2018   2   3   4   5   6   7   8   9  10  11  12  13
2019  14  15  16  17  18  19  20  21  22  23  24    
&gt; lag(x, -1)
     Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
2018       1   2   3   4   5   6   7   8   9  10  11
2019  12  13  14  15  16  17  18  19  20  21  22  23
2020  24 
</code></pre>

<p>时滞与前导对于比较同一个时间序列中处于不同时间节点的数据非常有帮助。比如我们只需要使用<code>x - lag(x, -1)</code>，就可以计算<strong>x</strong>在每个时刻的<strong>同比增长量</strong>。</p>

<p>时间序列与其时滞或前导之间的差值可以被称作<strong>差分</strong>。在R语言中我们可以使用函数<span class="highlight-text primary">diff</span>来计算差分：</p>

<p><code>diff(x, lag = n, differences = m)</code></p>

<ul>
<li><strong>x</strong>即需要进行差分的时间序列</li>
<li><strong>lag</strong>代表将<strong>x</strong>与其<strong>n阶</strong>前导进行差分</li>
<li><strong>differences</strong>代表进行<strong>m次</strong>差分</li>
</ul>

<p>注意，这里我们计算同比增长量其实就是计算1阶1次差分，计算环比增长量实际上就是计算12阶1次差分。<strong>时滞</strong>、<strong>前导</strong>与<strong>差分</strong>有以下关系：</p>

<p>$$\begin{cases}
  diff(x, 1, 1) = x - lag(x, -1) \\
  diff(x, 2, 1) = x - lag(x, -2) \\
  diff(x, 1, 2) = (x - lag(x, -1)) - lag((x - lag(x, -1)), -1)
\end{cases}$$</p>

<p><br></p>

<h2 id="5-2-时间序列的累计算法">5.2、时间序列的累计算法</h2>

<p>我们可以使用<span class="highlight-text primary">sum</span>、<span class="highlight-text primary">prod</span>函数分别计算数组中所有元素的<strong>和</strong>、<strong>连乘积</strong>，但对于时间序列，有时候我们更想知道随着时间的推移，各元素的和、连乘积是如何变化的。这时候我们就可以分别使用<span class="highlight-text primary">cumsum</span>、<span class="highlight-text primary">cumprod</span>，分别求累计的和或积。相应的，我们还可以分别使用<span class="highlight-text primary">cummax</span>、<span class="highlight-text primary">cummin</span>来求累计的最大、最小值。</p>

<p>注意累计算法生成的数组与原始数组等长，其中每个位置上的值，都是原始数组中起始位置到该位置的所有元素，通过相应的算法（求和、求积等）生成的值。</p>

<pre><code class="language-R">&gt; sum(1:5)
[1] 15
&gt; cumsum(1:5)
[1]  1  3  6 10 15
&gt; prod(1:5)
[1] 120
&gt; cumprod(1:5)
[1]   1   2   6  24 120
</code></pre>

<p><br></p>

<h2 id="5-3-时间序列的ar-ma式累计">5.3、时间序列的AR、MA式累计</h2>

<p>对于时间序列，有时候我们特别需要使用<strong>移动平均系数</strong>或<strong>自相关系数</strong>进行累计（求和/求均值等），那么我们就可以使用<span class="highlight-text primary">filter</span>函数：</p>

<p><code>filter(x, filter, method = c(&quot;convolution&quot;, &quot;recursive&quot;), sides = 2, circular = FALSE, init)</code></p>

<ul>
<li><strong>x、filter</strong>分别代表<strong>原数组</strong>和<strong>AR/MA累计系数</strong></li>
<li><strong>method</strong>取值为<strong>convolution</strong>或<strong>recursive</strong>时，分别代表<strong>移动平均式的累计</strong>、<strong>自回归式的累计</strong></li>
<li><strong>sides</strong>只对<strong>移动平均式的累计</strong>有效，取值为<strong>1</strong>或<strong>2</strong>时，分别代表<strong>向前累计</strong>、<strong>向两端累计</strong></li>
<li><strong>circular</strong>只对<strong>移动平均式的累计</strong>有效，表示是否循环利用原始数组</li>
<li><strong>init</strong>只对<strong>自回归式的累计</strong>有效，可以用于生成累计结果的初始值</li>
</ul>

<p>如果我们分别使用<strong>X、Y、F、p、o</strong>代表<strong>原数组、累计后的数组、累计系数、累计系数的长度、偏移量</strong>(注意偏移量仅与<strong>sides</strong>参数相关)，则<strong>AR、MA累计</strong>过程可以分别用以下公式表示：</p>

<p>$$Yi = Xi + F_1*Y(i-1) + … + Fp*Y(i-p) \\
Yi = F_1*X(i+o) + … + Fp*X(i+o-(p-1))$$</p>

<p>$$o = \begin{cases}
  0 &amp;\text{if } (sides = 1)\\
  (p \%\% 2) &amp;\text{if } (sides = 2)
\end{cases}$$</p>

<p>

 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure nocaption fig-33" >
  
    <a class="fancybox" href="https://s2.ax1x.com/2019/08/04/eyNKC6.gif" data-fancybox-group="group:travel1">
  
    <img class="fig-img" src="https://s2.ax1x.com/2019/08/04/eyNKC6.gif" >
  
    </a>
  
  
</div>



 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure nocaption fig-33" >
  
    <a class="fancybox" href="https://s2.ax1x.com/2019/08/04/eyNVb9.gif" data-fancybox-group="group:travel1">
  
    <img class="fig-img" src="https://s2.ax1x.com/2019/08/04/eyNVb9.gif" >
  
    </a>
  
  
</div>


 
  
  
  
  
    
      
    
  
    
      
    
  
    
      
    
  
    
  

 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure nocaption fig-33" >
  
    <a class="fancybox" href="https://s2.ax1x.com/2019/08/04/eyNeER.gif" data-fancybox-group="group:travel1">
  
    <img class="fig-img" src="https://s2.ax1x.com/2019/08/04/eyNeER.gif" >
  
    </a>
  
  
</div>

  <div style="clear:both;"></div>



 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure nocaption fig-50" >
  
    <a class="fancybox" href="https://s2.ax1x.com/2019/08/04/eyNmU1.gif" data-fancybox-group="group:travel2">
  
    <img class="fig-img" src="https://s2.ax1x.com/2019/08/04/eyNmU1.gif" >
  
    </a>
  
  
</div>


 
  
  
  
  
    
      
    
  
    
      
    
  
    
      
    
  
    
  

 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure nocaption fig-50" >
  
    <a class="fancybox" href="https://s2.ax1x.com/2019/08/04/eyNKC6.gif" data-fancybox-group="group:travel2">
  
    <img class="fig-img" src="https://s2.ax1x.com/2019/08/04/eyNKC6.gif" >
  
    </a>
  
  
</div>

  <div style="clear:both;"></div>
</p>

<p><br></p>

<h2 id="5-4-设置取值上-下限">5.4、设置取值上、下限</h2>

<p>当我们进行预测时，尤其对于时间序列，<strong>预测值</strong>有时会超出可接受范围（比如预测出销量小于0）。此时我们就可以分别使用<span class="highlight-text primary">pmin</span>、<span class="highlight-text primary">pmax</span>将超出可接受范围的预测值设置为取值上、下限。</p>

<pre><code class="language-R">&gt; pmin(1:5, 3)
[1] 1 2 3 3 3
&gt; pmax(1:5, 3)
[1] 3 3 3 4 5
</code></pre>

<p><br></p>

<h1 id="6-结语">6、结语</h1>

<p>关于R语言中对数组进行数学运算的介绍到此就算结束了，下一篇我将介绍如何在R语言中对<strong>矩阵</strong>类型的对象进行数学运算。</p>



  

<div style="width: 100%; margin: 1.5em 0; border: 1px solid #e6e6ff; border-radius:5px; overflow: hidden;">
  <div style="text-align: center; font-weight:bold; background-color: #e6e6ff; padding: 1rem;">
    思考思考
  </div>
  <div style="padding: 1rem;">
    <ul>
<li>如何生成一个由n<sup>2</sup>构成的数组（<strong>n</strong>为自然数）？</li>
<li>如何计算数组<strong>x</strong>的离差（<strong>n</strong>为数组<strong>x</strong>的长度）？</li>
</ul>

<p>$$\frac {\sum_{i = 1}^n |x_i - mean(x)|} n$$</p>

<ul>
<li>如何求时间序列的七日移动平均？</li>
</ul>

  </div>
</div>

<p><br></p>
              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">标签</span><br/>
                    
  <a class="tag tag--primary tag--small" href="../../../tags/r%E8%AF%AD%E8%A8%80%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97/">R语言数学运算</a>

                  </div>
                
              
            
            
<div id="gitmentContainer"></div>
<link rel="stylesheet" href="../../../css/gitment.css">
<script src="../../../js/gitment.js"></script>
<script>
    var gitment = new Gitment({
        id: '使用R语言对数组进行数学运算',
        owner: 'supernum163',
        repo: 'wly',
        oauth: {
            client_id: '40f2576aa2a372d81a1a',
            client_secret: 'c7f5edfb420146da2eed5a09576aaea56f402d30',
        },
    });
    gitment.render('gitmentContainer')
</script>

            <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="../../../2019/04/%E4%BD%BF%E7%94%A8r%E8%AF%AD%E8%A8%80%E5%AF%B9%E6%95%B0%E5%AD%97%E8%BF%9B%E8%A1%8C%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97/" data-tooltip="使用R语言对数字进行数学运算">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="../../../2019/04/%E4%BD%BF%E7%94%A8r%E8%AF%AD%E8%A8%80%E5%AF%B9%E7%9F%A9%E9%98%B5%E8%BF%9B%E8%A1%8C%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97/" data-tooltip="使用R语言对矩阵进行数学运算">
              
                  <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default tooltip--top" target="new" href="http://service.weibo.com/share/share.php?title=title&amp;url=/2019/04/%E4%BD%BF%E7%94%A8r%E8%AF%AD%E8%A8%80%E5%AF%B9%E6%95%B0%E7%BB%84%E8%BF%9B%E8%A1%8C%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97/&amp;source=bookmark#_loginLayer_1551323382531" data-tooltip="分享到 新浪微博">
              <i class="fa fa-weibo"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default tooltip--top" target="new" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=/2019/04/%E4%BD%BF%E7%94%A8r%E8%AF%AD%E8%A8%80%E5%AF%B9%E6%95%B0%E7%BB%84%E8%BF%9B%E8%A1%8C%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97/" data-tooltip="分享到 QQ空间">
              <i class="fa fa-qq"></i>
            </a>
          </li>
        
        <li class="post-action hide-xs">
          <a class="post-action-btn btn btn--default tooltip--top show-url-btn-open" data-tooltip="分享到  微信" >
            <i class="fa fa-weixin"></i>
          </a>
        </li>
      
      <li class="post-action">
      
        <a class="post-action-btn btn btn--default tooltip--top" href="#gitmentContainer" data-tooltip="写下评论">
        <i class="fa fa-commenting-o"></i>
      
        </a>
      </li>
      <li class="post-action">
        <a class="post-action-btn btn btn--default tooltip--top" href="#" data-tooltip="回到顶部">
          <i class="fa fa-arrow-up"></i>
        </a>
      </li>
    </ul>
  
</div>

          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2020 <a href="https://github.com/supernum163">supernum</a>. 保留所有权
  </span>
</footer>

      </div>
      
        <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
          <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="../../../2019/04/%E4%BD%BF%E7%94%A8r%E8%AF%AD%E8%A8%80%E5%AF%B9%E6%95%B0%E5%AD%97%E8%BF%9B%E8%A1%8C%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97/" data-tooltip="使用R语言对数字进行数学运算">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="../../../2019/04/%E4%BD%BF%E7%94%A8r%E8%AF%AD%E8%A8%80%E5%AF%B9%E7%9F%A9%E9%98%B5%E8%BF%9B%E8%A1%8C%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97/" data-tooltip="使用R语言对矩阵进行数学运算">
              
                  <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default tooltip--top" target="new" href="http://service.weibo.com/share/share.php?title=title&amp;url=/2019/04/%E4%BD%BF%E7%94%A8r%E8%AF%AD%E8%A8%80%E5%AF%B9%E6%95%B0%E7%BB%84%E8%BF%9B%E8%A1%8C%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97/&amp;source=bookmark#_loginLayer_1551323382531" data-tooltip="分享到 新浪微博">
              <i class="fa fa-weibo"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default tooltip--top" target="new" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=/2019/04/%E4%BD%BF%E7%94%A8r%E8%AF%AD%E8%A8%80%E5%AF%B9%E6%95%B0%E7%BB%84%E8%BF%9B%E8%A1%8C%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97/" data-tooltip="分享到 QQ空间">
              <i class="fa fa-qq"></i>
            </a>
          </li>
        
        <li class="post-action hide-xs">
          <a class="post-action-btn btn btn--default tooltip--top show-url-btn-open" data-tooltip="分享到  微信" >
            <i class="fa fa-weixin"></i>
          </a>
        </li>
      
      <li class="post-action">
      
        <a class="post-action-btn btn btn--default tooltip--top" href="#gitmentContainer" data-tooltip="写下评论">
        <i class="fa fa-commenting-o"></i>
      
        </a>
      </li>
      <li class="post-action">
        <a class="post-action-btn btn btn--default tooltip--top" href="#" data-tooltip="回到顶部">
          <i class="fa fa-arrow-up"></i>
        </a>
      </li>
    </ul>
  
</div>

        </div>
        
  <div id="share-options-bar" class="share-options-bar" data-behavior="4">
    <i id="btn-close-shareoptions" class="fa fa-close"></i>
    <ul class="share-options">
      
        <li class="share-option">
          <a class="share-option-btn" target="new" href="http://service.weibo.com/share/share.php?title=title&amp;url=%2F2019%2F04%2F%25E4%25BD%25BF%25E7%2594%25A8r%25E8%25AF%25AD%25E8%25A8%2580%25E5%25AF%25B9%25E6%2595%25B0%25E7%25BB%2584%25E8%25BF%259B%25E8%25A1%258C%25E6%2595%25B0%25E5%25AD%25A6%25E8%25BF%2590%25E7%25AE%2597%2F&amp;source=bookmark#_loginLayer_1551323382531">
            <i class="fa fa-weibo"></i><span>分享到 新浪微博</span>
          </a>
        </li>
      
        <li class="share-option">
          <a class="share-option-btn" target="new" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=%2F2019%2F04%2F%25E4%25BD%25BF%25E7%2594%25A8r%25E8%25AF%25AD%25E8%25A8%2580%25E5%25AF%25B9%25E6%2595%25B0%25E7%25BB%2584%25E8%25BF%259B%25E8%25A1%258C%25E6%2595%25B0%25E5%25AD%25A6%25E8%25BF%2590%25E7%25AE%2597%2F">
            <i class="fa fa-qq"></i><span>分享到 QQ空间</span>
          </a>
        </li>
      
        <li class="share-option">
          <a class="share-option-btn show-url-btn-open" href="#show-url-background">
            <i class="fa fa-weixin"></i><span>分享到  微信</span>
          </a>
        </li>
    </ul>
  </div>
  <div id="share-options-mask" class="share-options-mask"></div>

      
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    <img id="about-card-picture" src="https://s2.ax1x.com/2019/10/19/KmV65q.png" alt="作者的图片" />
    <h4 id="about-card-name">wly</h4>
    
      <div id="about-card-bio" style="margin: 0">仍是年少不知愁</div>
    
    
      <div id="about-card-bio">Still young. Still alive</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        数据分析师
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        中国 上海
      </div>
    
  </div>
</div>

    
    
  
    <div id="cover" style="background-color: #171314;"></div>
  


    
<script src="../../../js/jquery.min.js"></script>
<script src="../../../js/jquery.fancybox.min.js"></script>
<script src="../../../highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script src="../../../js/script-qi9wbxp2ya2j6p7wx1i6tgavftewndznf4v0hy2gvivk1rxgc3lm7njqb6bz.min.js"></script>



  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      CommonHTML: { linebreaks: { automatic: true } },
      tex2jax: { inlineMath: [ ['$', '$'], ['\\(','\\)'] ], displayMath: [ ['$$','$$'], ['\\[', '\\]'] ], processEscapes: false },
      messageStyle: 'none'
    });
  </script>









<script lang="javascript">
window.onload = updateMinWidth;
window.onresize = updateMinWidth;
document.getElementById("sidebar").addEventListener("transitionend", updateMinWidth);
function updateMinWidth() {
  var sidebar = document.getElementById("sidebar");
  var main = document.getElementById("main");
  main.style.minWidth = "";
  var w1 = getComputedStyle(main).getPropertyValue("min-width");
  var w2 = getComputedStyle(sidebar).getPropertyValue("width");
  var w3 = getComputedStyle(sidebar).getPropertyValue("left");
  main.style.minWidth = `calc(${w1} - ${w2} - ${w3})`;
}
</script>

    

  <style>
    #show-url-background {
      margin:0px;
      padding:0px;
      width:100%;
      height:100%;
      background-color:rgba(136,135,134,0.5);
      position:fixed;
      display:none;
      z-index:1000;
    }
    
    #show-url-card{
      text-align: center;
      position: relative; 
      top:50%; 
      left:50%;
      transform: translate(-50%, -50%);
      max-width:400px;
      max-height:400px;
      padding:5rem 0 3rem 0;
      background-color:#888786;
      display:none;
    }
    
    #show-url-describe{
      margin:2rem 0 0 0;
      color:white;
    }
  
    #show-url-btn-close {
      position: absolute; 
      top: 5px;
      right: 15px;
      color:white;
    }
  </style>

  <div id="show-url-background">
    <div id="show-url-card">
      <div id="show-url-btn-close">
        <i class="fa fa-remove"></i>
      </div>
      <div id="show-url-qrcode"></div> 
      <p id="show-url-describe">扫描上方二维码分享到微信</p>
    </div>
  </div>
  
  <script src="../../../js/qrcode.min.js"></script>

  <script type="text/javascript">
    new QRCode(document.getElementById("show-url-qrcode"), window.location.href);
    
    $(".show-url-btn-open").click(function(){
      $("#show-url-background").css("display", "block");
      $("#show-url-card").css("display", "block");
    }); 
    $("#show-url-btn-close").click(function(){
      $("#show-url-background").css("display", "none");
      $("#show-url-card").css("display", "none");
    }); 
  </script>
  

    
  </body>
</html>
