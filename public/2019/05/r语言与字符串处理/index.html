<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="author" content="wly">
<meta name="keywords" content="R语言, 数据类型, 字符串处理, wly的博客, supernum">
<meta name="description" content="文本信息作为我们最常见的信息来源，当然也可以被用于数据分析。文本分析离不开强大的字符串处理能力，这篇文章将介绍如何在R语言中进行字符串处理。">


  
    <meta property="article:published_time" content="2019-05-27T00:00:00">
  
  
    <meta property="article:modified_time" content="2019-05-27T00:00:00">
  
  
  
    
      <meta property="article:section" content="R语言">
    
      <meta property="article:section" content="数据类型">
    
  
  
    
      <meta property="article:tag" content="R语言数据类型">
    
  



<meta property="og:locale" content="zh-cn">
<meta property="og:site_name" content="wly&#39;s notebook">
<meta property="og:url" content="/2019/05/r%E8%AF%AD%E8%A8%80%E4%B8%8E%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%84%E7%90%86/">
<meta property="og:type" content="article">
<meta property="og:title" content="R语言与字符串处理">
<meta property="og:description" content="文本信息作为我们最常见的信息来源，当然也可以被用于数据分析。文本分析离不开强大的字符串处理能力，这篇文章将介绍如何在R语言中进行字符串处理。">


  <meta property="og:image" content="https://s2.ax1x.com/2019/08/04/eyNCCV.png">





  <meta property="og:image" content="https://s2.ax1x.com/2019/10/19/KmV65q.png">


    <title>R语言与字符串处理</title>

    <link rel="canonical" href="../../../2019/05/r%E8%AF%AD%E8%A8%80%E4%B8%8E%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%84%E7%90%86/">
    <link rel="icon" href="../../../img/favicon.ico">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="../../../">

    
    
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/jquery.fancybox.min.css" />
    <link rel="stylesheet" href="../../../css/jquery.fancybox-thumbs.min.css" />
    <link rel="stylesheet" href="../../../highlight/styles/github.css">
    
    <link rel="stylesheet" href="../../../css/style-nnm2spxvve8onlujjlegkkytaehyadd4ksxc1hyzzq9a2wvtrgbljqyulomn.min.css" />
    
    

    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="../../../">wly&#39;s notebook</a>
  </div>
  
    
      <a class="header-right-picture "
         href="../../../#about">
    
    
    
      
        <img class="header-picture" src="https://s2.ax1x.com/2019/10/19/KmV65q.png" alt="作者的图片" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    <div class="sidebar-profile">
      <a href="../../../#about">
        <img class="sidebar-profile-picture" src="https://s2.ax1x.com/2019/10/19/KmV65q.png" alt="作者的图片" />
      </a>
      <h4 class="sidebar-profile-name">wly</h4>
      
        <h5 class="sidebar-profile-bio">仍是年少不知愁</h5>
      
      
        <h5 class="sidebar-profile-bio" style="margin-top: 0">Still young. Still alive</h5>
      
    </div>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="../../../">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">首页</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="../../../categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">分类</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="../../../tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">标签</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="../../../archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">归档</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="../../../page/about">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">关于</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/supernum163" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="mailto:supernum@163.com" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-at"></i>
      
      <span class="sidebar-button-desc">Email</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="../../../page/donate">
    
      <i class="sidebar-button-icon fa fa-lg fa-rmb"></i>
      
      <span class="sidebar-button-desc">打赏</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="../../../index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title" itemprop="headline">
      R语言与字符串处理
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="publishDate" datetime="2019-05-27T00:00:00Z">
        
  
  
  
  
    2019-05-27
  

      </time>
    
    
  
  
    <span>发布在</span>
    
      <a class="category-link" href="../../../categories/r%e8%af%ad%e8%a8%80">R语言</a>, 
    
      <a class="category-link" href="../../../categories/%e6%95%b0%e6%8d%ae%e7%b1%bb%e5%9e%8b">数据类型</a>
    
  

    
  </div>

</div>
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              <p><strong>文本信息</strong>作为我们最常见的信息来源，当然也可以被用于数据分析。<strong>文本分析</strong>离不开强大的字符串处理能力，这篇文章将介绍如何在<strong>R语言</strong>中进行<strong>字符串</strong>处理。</p>

<h1 id="table-of-contents">目录</h1><nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#1-字符串的基本操作">1、字符串的基本操作</a>
<ul>
<li><a href="#1-1-字符串长度">1.1、字符串长度</a></li>
<li><a href="#1-2-截取字符串">1.2、截取字符串</a></li>
<li><a href="#1-3-字符串拼接与分割">1.3、字符串拼接与分割</a></li>
<li><a href="#1-4-简单查找">1.4、简单查找</a></li>
<li><a href="#1-5-字符替换">1.5、字符替换</a></li>
</ul></li>
<li><a href="#2-正则表达式">2.正则表达式</a>
<ul>
<li><a href="#2-1-正则查找">2.1、正则查找</a></li>
<li><a href="#2-2-正则匹配">2.2、正则匹配</a></li>
<li><a href="#2-3-正则替换">2.3、正则替换</a></li>
<li><a href="#2-4-取正则匹配结果">2.4、取正则匹配结果</a></li>
</ul></li>
<li><a href="#3-模糊查找匹配">3、模糊查找匹配</a>
<ul>
<li><a href="#3-1-计算字符串相似度">3.1、计算字符串相似度</a></li>
<li><a href="#3-2-模糊查找">3.2、模糊查找</a></li>
<li><a href="#3-3-模糊匹配">3.3、模糊匹配</a></li>
</ul></li>
<li><a href="#4-字符与编码">4、字符与编码</a></li>
</ul></li>
</ul>
</nav>

<h2 id="1-字符串的基本操作">1、字符串的基本操作</h2>

<p>在R语言中，包含在两个英文<strong>双引号</strong>或者<strong>单引号</strong>之间的任意内容都会被视为字符串。如果我们想要输入一个包含字符<code>&quot;</code>（或者<code>'</code>）的字符串，则需要使用转义符<code>\</code>作为前缀。同样如果我们包含字符<code>\</code>，也需要加入转义符前缀。注意转义符并不是一个单独的字符，它与被转义的字符共同组成一个字符，比如<code>\t</code>表示制表符。</p>

<p>我们可以使用<span class="highlight-text primary">print</span>函数（或者直接使用<strong>变量</strong>的形式），查看被转义之前的字符串。但这种方法有时候不容易区分出哪些是转义字符，哪些是真正的字符。想要查看字符串的转义结果，则可以使用<span class="highlight-text primary">cat</span>函数。</p>

<pre><code class="language-R">&gt; &quot; 注意 \&quot;\\t\&quot; 与 \&quot;\t \&quot; 不同 &quot;
[1] &quot; 注意 \&quot;\\t\&quot; 与 \&quot;\t \&quot; 不同 &quot;
&gt; cat(&quot; 注意 \&quot;\\t\&quot; 与 \&quot;\t \&quot; 不同 &quot;)
 注意 &quot;\t&quot; 与 &quot;	 &quot; 不同 
</code></pre>

<p><br></p>

<h3 id="1-1-字符串长度">1.1、字符串长度</h3>

<p>我们可以使用命令<span class="highlight-text primary">nchar(x, type = c("bytes", "chars", "width"))</span>，来查看字符串的长度。这里<strong>type</strong>参数的三个取值分别表示：查看字符串占用多少个字节；查看字符串包含多少个字符；查看输出字符串时需要占用的宽度。 注意一个英文字符（或ascii字符）的宽度总是为1，而一个中文字符的宽度总是为2。</p>

<pre><code class="language-R">&gt; nchar(&quot;abc\t中文&quot;)
[1] 6
&gt; nchar(&quot;abc\t中文&quot;, &quot;bytes&quot;)
[1] 10
&gt; nchar(&quot;abc\t中文&quot;, &quot;width&quot;)
[1] 8
</code></pre>

<p><br></p>

<h3 id="1-2-截取字符串">1.2、截取字符串</h3>

<p>在R语言中截取字符串的函数是<span class="highlight-text primary">substr、substring</span>。这两个函数都需要指明需要被截取的<strong>原字符串</strong>，以及截取的<strong>起始位置</strong>与<strong>终止位置</strong>，不同的是<strong>substr</strong>总是会生成一个与原字符串数组等长的数组，而<strong>substring</strong>会循环利用其参数，最终生成的结果总是与三个数组参数中最长的数组等长。</p>

<p>根据以上规则，我们不但可以截取一个字符串（或字符串数组）中的一部分，也可以对同一个字符串进行多次截取。对一个字符串数组中的不同元素使用不同的截取模式。此外我们还可以直接替换掉被截取的部分。</p>

<pre><code class="language-R">&gt; x &lt;- c(&quot;abcdefg&quot;, &quot;ghijkl&quot;)
&gt; substr(x, start = 2, stop = 4)
[1] &quot;bcd&quot; &quot;hij&quot;
&gt; substring(x[1], first = 1:6, last = 1:6)
[1] &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; &quot;e&quot; &quot;f&quot;
&gt; substr(x, 2, 4:5)
[1] &quot;bcd&quot;  &quot;hijk&quot;
&gt; substring(x, 2) &lt;- c(&quot;..&quot;, &quot;+++&quot;); x
[1] &quot;a..defg&quot; &quot;g+++kl&quot; 
</code></pre>

<p><br></p>

<h3 id="1-3-字符串拼接与分割">1.3、字符串拼接与分割</h3>

<p>在R语言中我们可以分别使用<span class="highlight-text primary">paste、strsplit</span>函数进行字符串拼接与分割，它们的使用方式分别如下:</p>

<p><code>paste (..., sep = &quot; &quot;, collapse = NULL)</code></p>

<ul>
<li><strong>&hellip;</strong>表示需要拼接的一个或多个字符串、字符串数组</li>
<li><strong>sep</strong>即拼接符，默认为一个空格，用于拼接多个参数</li>
<li><strong>collapse</strong>即拼接符，用于将一个字符串数组拼接成一个字符串</li>
</ul>

<p><code>strsplit(x, split, ...)</code></p>

<ul>
<li><strong>x</strong>表示需要分割的字符串或字符串数组</li>
<li><strong>split</strong>即分割符，可以是一个特定的字符或字符串，也可以使用 <a href="#正则表达式">正则表达式</a></li>
</ul>

<p>注意<strong>strsplit</strong>会生成一个列表，其中每个元素都是一个数组，代表被分割对象中相应元素的分割结果。R语言中拥有两个系统数组<strong>LETTERS、letters</strong>分别记录了26个大小写字母，我们可以使用这两个数组演示字符串的拼接与分割：</p>

<pre><code class="language-R">&gt; paste(LETTERS[1:7], letters[1:7], sep = &quot; &quot;)
[1] &quot;A a&quot; &quot;B b&quot; &quot;C c&quot; &quot;D d&quot; &quot;E e&quot; &quot;F f&quot; &quot;G g&quot;
&gt; paste(letters, collapse = &quot;&quot;)
[1] &quot;abcdefghijklmnopqrstuvwxyz&quot;
&gt; strsplit(&quot;abcdefg&quot;, split = NULL)
[[1]]
[1] &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; &quot;e&quot; &quot;f&quot; &quot;g&quot;
</code></pre>

<p><br></p>

<h3 id="1-4-简单查找">1.4、简单查找</h3>

<p>有时候我们需要判断字符串是否以某个<strong>前缀</strong>开头，或者以某个<strong>后缀</strong>结尾，则可以分别使用<span class="highlight-text primary">startsWith、endsWith</span>函数</p>

<p>如果我们想要知道一个字符串数组（<strong>查找表</strong>）中，某个字符串（或包含某个前缀的字符串）所在位置，则可以分别使用<span class="highlight-text primary">match、pmatch、charmatch</span>函数。其中：</p>

<ul>
<li><strong>match</strong>函数相当于全字查找，查找某个字符串在字符串数组中的位置</li>
<li><strong>pmatch、charmatch</strong>函数能以前缀查找，但全字查找的顺序优先于前缀查找。不同的是<strong>pmatch</strong>可以指定<strong>duplicates.ok = FALSE</strong>，表示当查找表中的某个元素被查找到一次之后就不再使用</li>
<li>三个函数中都可以指定参数<strong>nomatch</strong>的值，表示查找不到时应该返回的值</li>
<li>如果前缀在查找表中没有区分度，<strong>charmatch</strong>会返回0，而<strong>pmatch</strong>会返回查找不到</li>
<li><strong>pmatch</strong>不能查找空字符</li>
</ul>

<p>R语言中正是大量使用了这里的字符查找模式，所以当我们调用函数时，很多情况下函数的参数名、参数取值都可以简写。</p>

<pre><code class="language-R">&gt; pmatch(x = c(&quot;&quot;, &quot;ab&quot;, &quot;ab&quot;), table = c(&quot;abc&quot;, &quot;ab&quot;), dup = FALSE)
[1] NA  2  1
&gt; charmatch(c(&quot;&quot;, &quot;ab&quot;, &quot;ab&quot;), c(&quot;abc&quot;, &quot;ab&quot;))
[1] 0 2 2
</code></pre>

<p><br></p>

<h3 id="1-5-字符替换">1.5、字符替换</h3>

<p>在R语言中我们可以分别使用<span class="highlight-text primary">toupper、tolower</span>函数，或者使用命令<span class="highlight-text primary">casefold(x, upper = c(TRUE, FALSE))</span>的形式，对英文字符进行大小写转换。类似的我们也可以使用<span class="highlight-text primary">chartr(old, new, x)</span>的形式，将字符串<strong>x</strong>中的任意<strong>old</strong>字符替换为<strong>new</strong>字符，注意<strong>old</strong>与<strong>new</strong>中的字符需要一一对应。</p>

<pre><code class="language-R">&gt; c(toupper(&quot;aBcDeFg&quot;), casefold(&quot;aBcDeFg&quot;))
[1] &quot;ABCDEFG&quot; &quot;abcdefg&quot;
&gt; chartr(old = &quot;大ABC&quot;, new = &quot;小abc&quot;, x = &quot;大写字母: ABC&quot;)
[1] &quot;小写字母: abc&quot;
</code></pre>

<p><br></p>

<h2 id="2-正则表达式">2.正则表达式</h2>

<p>正则表达式是一种模式（或规则），可以被用于查找、匹配或替换文本中相应的，或者说符合某种模式的内容。R语言中的正则表达式包含了普通的正则表达式、<strong>扩展正则表达式</strong>、<strong>perl正则表达式</strong>，参考<code>regex</code>帮助文档。此外R语言中使用正则表达式的函数，绝大部分都支持以下参数：</p>

<ul>
<li><strong>fixed</strong>表示是否表示严格按照字符查找匹配，取值为<strong>FALSE</strong>时表示将字符作为正则表达式进行查找匹配</li>
<li><strong>ignore.case</strong>表示是否忽略大小写</li>
<li><strong>perl</strong>表示是否使用<strong>perl</strong>正则表达式</li>
<li><strong>useBytes</strong>表示按照<strong>字节</strong>或按照<strong>字符</strong>进行查找匹配</li>
</ul>

<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">正则表达式</th>
<th align="left">解释说明</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">ascii字符</td>
<td align="left">\t、\n、\r、……</td>
<td align="left">匹配<strong>制表符</strong>、<strong>换行符</strong>、<strong>回车符</strong>等特定ascii字符</td>
</tr>

<tr>
<td align="left">字符编码</td>
<td align="left">\x09、\x0a、\0d、……</td>
<td align="left">按照字符编码，匹配<strong>制表符</strong>、<strong>换行符</strong>、<strong>回车符</strong>等特定字符</td>
</tr>

<tr>
<td align="left">特殊字符</td>
<td align="left">\</td>
<td align="left">转义符</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">\\d</td>
<td align="left">匹配任意数字（0-9）</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">\\D</td>
<td align="left">反向匹配任意数字</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">\\w</td>
<td align="left">匹配任意字符</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">\\W</td>
<td align="left">反向匹配任意字符</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">\\s</td>
<td align="left">匹配任意空白字符</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">\\S</td>
<td align="left">反向匹配任意空白字符</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">.</td>
<td align="left">匹配除换行符之外的任意字符</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">()</td>
<td align="left">标记一个子表达式</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">[]</td>
<td align="left">匹配方括号内的任意字符</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">[n-m]</td>
<td align="left">匹配字符编码在字符n到m之间的任意字符</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">n</td>
<td align="left">m</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">^</td>
<td align="left">匹配字符串开头，结合方括号时表示反向匹配某个字符</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">$</td>
<td align="left">匹配字符串结尾</td>
</tr>

<tr>
<td align="left">限定符</td>
<td align="left">?</td>
<td align="left">匹配0次或1次</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">+</td>
<td align="left">匹配1次或多次</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">*</td>
<td align="left">匹配任意次数</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">{n}</td>
<td align="left">匹配n次</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">{n, m}</td>
<td align="left">匹配n到m次（n或m其中一方可为空）</td>
</tr>

<tr>
<td align="left">扩展正则表达式</td>
<td align="left">[[:digit:]]</td>
<td align="left">匹配十进制数字</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">[[:xdigit:]]</td>
<td align="left">匹配十六进制数字</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">[[:alpha:]]</td>
<td align="left">匹配大小写字母</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">[[:lower:]]</td>
<td align="left">匹配小写字母</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">[[:upper:]]</td>
<td align="left">匹配大写字母</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">[[:alnum:]]</td>
<td align="left">匹配大小写字母和数字</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">[[:blank:]]</td>
<td align="left">匹配空白字符（空格、\t）</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">[[:space:]]</td>
<td align="left">匹配空白字符（空格、\t、\n、\r、\v、\f）</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">[[:cntrl:]]</td>
<td align="left">匹配不可打印的控制字符（\x00-\x1f、\x7f）</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">[[:graph:]]</td>
<td align="left">匹配可打印的非空白字符</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">[[:print:]]</td>
<td align="left">匹配可打印字符</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">[[:punct:]]</td>
<td align="left">匹配标点符号</td>
</tr>
</tbody>
</table>

<p><br></p>

<h3 id="2-1-正则查找">2.1、正则查找</h3>

<p>上文我们介绍了如何使用<strong>match</strong>家族的函数对字符串进行简单查找，如果我们需要使用正则表达式的形式，根据某种模式查找字符串（或字符串数组），则可以使用以下函数：</p>

<pre><code class="language-R">grepl(pattern, x, ...)
grep(pattern, x, value = FALSE, invert = FALSE, ...)
grepRaw(pattern, x, value = FALSE, invert = FALSE, offset = 1L, all = FALSE, ...)
</code></pre>

<ul>
<li><strong>pattern</strong>即需要查找的正则表达式</li>
<li><strong>x</strong>即需要被查找的字符串或字符串数组</li>
<li><strong>value</strong>表示是否直接返回查找到的值，取值为<strong>FALSE</strong>时表示返回查找到的字符串所在位置</li>
<li><strong>invert</strong>表示是否反向匹配<strong>pattern</strong></li>
<li><strong>offset</strong>表示需要略过多少个字节</li>
<li><strong>all</strong>表示是否查找全部匹配项，取值为<strong>FALSE</strong>时表示只返回第一个查找到的值</li>
</ul>

<p>其中<strong>grepl</strong>函数会返回逻辑值，表示是否查找到特定模式；<strong>grep</strong>函数会返回查找到的字符串，或者查找到的字符串所在字符串数组中的位置；<strong>grepRaw</strong>函数是按照字节查找，可以进行多次查找，但查找的模式与被查找的字符串都必须为单一的字符串，最终返回符合特定模式的内容在字符串中的位置（第多少个字节）。</p>

<pre><code class="language-R">&gt; grepl(pattern = &quot;[ab]&quot;, x = c(&quot;abc&quot;, &quot;def&quot;))
[1]  TRUE FALSE
&gt; grep(&quot;[ab]&quot;, c(&quot;abc&quot;, &quot;def&quot;), value = TRUE)
[1] &quot;abc&quot;
&gt; grep(&quot;[ab]&quot;, c(&quot;abc&quot;, &quot;def&quot;), invert = TRUE)
[1] 2
&gt; grepRaw(&quot;[ab]&quot;, &quot;abcabc&quot;, offset = 3L, all = TRUE)
[1] 4 5
</code></pre>

<p><br></p>

<h3 id="2-2-正则匹配">2.2、正则匹配</h3>

<p>如果我们需要以某种模式<strong>pattern</strong>从字符串（或字符串数组）<strong>x</strong>中匹配到特定的内容，并最终获得匹配的起始位置及匹配长度，则可以使用<span class="highlight-text primary">regexpr、regexec、gregexpr</span>等函数。注意：</p>

<ul>
<li><strong>regexpr、regexec</strong>只对<strong>x</strong>中的每个元素匹配一次，而<strong>gregexpr</strong>则可以匹配所有符合<strong>pattern</strong>的内容</li>
<li><strong>regexpr、regexec、gregexpr</strong>返还的值与<strong>x</strong>中每个元素的匹配位置一一对应，匹配长度则存放在与匹配长度对应的<strong>match.length</strong>属性中</li>
<li><strong>regexec</strong>返回一个数组， <strong>regexec</strong>返回一个列表，列表中每个元素仅包含一个值，<strong>gregexpr</strong>也返回一个列表，但列表中每个元素可以包含多个值，</li>
</ul>

<pre><code class="language-R">&gt; regexpr(pattern = &quot;ab&quot;, x = &quot;abcabc&quot;)
[1] 1
attr(,&quot;match.length&quot;)
[1] 2
&gt; regexec(&quot;ab&quot;, &quot;abcabc&quot;)
[[1]]
[1] 1
attr(,&quot;match.length&quot;)
[1] 2
&gt; gregexpr(&quot;ab&quot;, &quot;abcabc&quot;)
[[1]]
[1] 1 4
attr(,&quot;match.length&quot;)
[1] 2 2
</code></pre>

<p><br></p>

<h3 id="2-3-正则替换">2.3、正则替换</h3>

<p>n为正整数，仅用于正则替换，表示引用正则表达式中第n个子表达式</p>

<p>如果我们需要将字符串（或字符串数组）<strong>x</strong>中符合特定模式<strong>pattern</strong>的内容，替换为另外的内容<strong>replacement</strong>，则可以使用函数<span class="highlight-text primary">sub、gsub</span>。其中<strong>sub</strong>只会对<strong>x</strong>中的每个元素替换一次，而<strong>gsub</strong>则会替换所有符合<strong>pattern</strong>的内容。此外如果我们在<strong>pattern</strong>中定义了子表达式，则可以使用<code>\\num</code>的形式，在<strong>replacement</strong>中引用第<strong>num</strong>个子表达式所对应的内容。</p>

<pre><code class="language-R">&gt; sub(pattern = &quot;(ab)c&quot;, replacement = &quot;\\1&quot; , x = &quot;abc ABC&quot;)
[1] &quot;ab ABC&quot;
&gt; gsub(&quot;ab&quot;, &quot;C&quot; , &quot;abc abc&quot;)
[1] &quot;Cc Cc&quot;
</code></pre>

<p><br></p>

<h3 id="2-4-取正则匹配结果">2.4、取正则匹配结果</h3>

<p>有时我们进行正则匹配并不是想要获取匹配的起始位置和匹配长度，而只是想要获取匹配的内容，或者替换匹配的内容。那么此时我们就可以使用<span class="highlight-text primary">regmatches</span>函数。<strong>regmatches</strong>需要以原始字符串、匹配结果作为参数，可以直接返回匹配的内容。</p>

<pre><code class="language-R">&gt; x &lt;- &quot;abc ABC&quot;
&gt; m &lt;- regexpr(&quot;ab&quot;, x)
&gt; regmatches(x, m)
[1] &quot;ab&quot;
&gt; m &lt;- gregexpr(&quot;ab&quot;, x, ignore.case = TRUE)
&gt; regmatches(x, m)
[[1]]
[1] &quot;ab&quot; &quot;AB&quot;
&gt; regmatches(x, m) &lt;- &quot;C&quot;; x
[1] &quot;Cc CC&quot;
</code></pre>

<p><br></p>

<h2 id="3-模糊查找匹配">3、模糊查找匹配</h2>

<p>模糊查找与模糊匹配可以从字符串（或字符串数组）中查找匹配与某个模式 <em>最相符</em> 的内容，但模糊查找与模糊匹配也需要遵守一定的规则，合理运用这些规则可以帮我们提高查找匹配的效率。</p>

<p><br></p>

<h3 id="3-1-计算字符串相似度">3.1、计算字符串相似度</h3>

<p>假设字符串<strong>x</strong>最少需要插入<strong>a</strong>次、删除<strong>b</strong>次、替换<strong>c</strong>次才能与字符串<strong>y</strong>相同，则<strong>x、y</strong>之间的 <em>距离</em> 即<strong>a、b、c</strong>的加权总和。比如将&rdquo;kitten&rdquo;转化为&rdquo;sitting&rdquo;，需要把“k”替换为“s”，把“e”替换为“i”，并在尾部插入“g”，所以共需1次插入、0次删除、2次替换，按照默认权重两者之间 <em>距离</em> 英该为3。</p>

<p>在R语言中，我们可以使用<span class="highlight-text primary">adist(x, y = NULL, costs = NULL, counts = FALSE, ...)</span>的形式，计算字符串之间的距离。其中：</p>

<ul>
<li><strong>costs</strong>即插入（<strong>insertions</strong>）、删除（<strong>deletions</strong>）、替换（<strong>substitutions</strong>）次数的权重</li>
<li><strong>counts</strong>表示是否输出插入、删除、替换次数</li>
<li><strong>partial</strong>表示是否只进行局部匹配</li>
</ul>

<pre><code class="language-R">&gt; drop(attr(adist(&quot;kitten&quot;, &quot;sitting&quot;, counts = TRUE), &quot;counts&quot;))
ins del sub 
  1   0   2
&gt; adist(&quot;lasy&quot;, &quot;1 lazy 2&quot;, partial = TRUE)
     [,1]
[1,]    1
</code></pre>

<p><br></p>

<h3 id="3-2-模糊查找">3.2、模糊查找</h3>

<p>我们可以通过<span class="highlight-text primary">agrep、agrepl</span>函数，进行模糊查找，这两个函数支持的参数与<strong>grep</strong>家族函数的参数类似，此外还拥有两个特有参数：</p>

<ul>
<li><strong>costs</strong>即插入、删除、替换次数的权重，参考<strong>adist</strong>的帮助文档</li>
<li><strong>max.distance</strong>即可以接受的最大距离，可以是插入、删除、替换的最大次数，也可以是三者之和（<strong>alll</strong>）的最大值，还可以是三者加权总和（<strong>cost</strong>）的最大值</li>
</ul>

<pre><code class="language-R">&gt; agrep(&quot;lasy&quot;, c(&quot; 1 lazy 2&quot;, &quot;1 lasy 2&quot;), max = list(sub = 0))
[1] 2
&gt; agrep(&quot;laysy&quot;, c(&quot;1 lazy&quot;, &quot;1&quot;, &quot;1 LAZY&quot;), max = 2, value = TRUE)
[1] &quot;1 lazy&quot;
</code></pre>

<p><br></p>

<h3 id="3-3-模糊匹配">3.3、模糊匹配</h3>

<p>上文我们已经介绍了使用正则表达式的匹配规则，以及 <strong>agrep</strong>家族函数的模糊查找规则，类似的我们可以通过<span class="highlight-text primary">aregexec</span>函数，进行模糊匹配。</p>

<pre><code class="language-R">&gt; x &lt;- c(&quot;1 lazy&quot;, &quot;1&quot;, &quot;1 LAZY&quot;)
&gt; aregexec(&quot;laysy&quot;, x, max.distance = 2)
[[1]]
[1] 3
attr(,&quot;match.length&quot;)
[1] 4

[[2]]
[1] -1
attr(,&quot;match.length&quot;)
[1] -1

[[3]]
[1] -1
attr(,&quot;match.length&quot;)
[1] -1
&gt; m &lt;- aregexec(&quot;(lay)(sy)&quot;, x, max.distance = 2)
&gt; regmatches(x, m)
[[1]]
[1] &quot;lazy&quot; &quot;la&quot;   &quot;zy&quot;  

[[2]]
character(0)

[[3]]
character(0)
</code></pre>

<p><br></p>

<h2 id="4-字符与编码">4、字符与编码</h2>

<ul>
<li><p><strong>二进制字符</strong>，计算机中的字符，本质上都是以一串二进制数据存储，通过特定的编码方式呈现在读者面前的。在R语言中，我们可以通过<span class="highlight-text primary">charToRaw、rawToChar</span>函数，在字符串与二进制数组之间互相转换。此外，我们还可以直接通过<span class="highlight-text primary">utf8ToInt</span>函数，查看字符在<strong>unicode</strong>字符表中对应的值。</p></li>

<li><p><strong>字符编码</strong>，有时候我们从外部读如字符串数据，有可能因为编码设置不正确而显示乱码。此时我们可以通过<span class="highlight-text primary">Encoding</span>函数，查看并设置字符的编码。</p></li>

<li><p><strong>字符转码</strong>，有时候我们遇到乱码不是因为字符编码设置的不正确，而是当前计算机操作系统不支持以特定的编码方式显示字符。此时我们可以使用<span class="highlight-text primary">iconv(x, from, to, ...)</span>的形式，将字符从一种编码方式转化为另一种编码方式。我们可以通过<span class="highlight-text primary">iconvlist(x, from, to, ...)</span>函数，查看R语言支持的所有编码方式。</p></li>
</ul>

<pre><code class="language-R">&gt; x &lt;- &quot;abc\xE7&quot;
&gt; charToRaw(x)
[1] 61 62 63 e7
&gt; Encoding(x) &lt;- &quot;latin1&quot;; x
[1] &quot;abcç&quot;
&gt; iconv(&quot;abc\xE7&quot;, from = &quot;latin1&quot;, to = &quot;UTF-8&quot;)
[1] &quot;abcç&quot;
</code></pre>

<p><br></p>



  

<div style="width: 100%; margin: 1.5em 0; border: 1px solid #e6e6ff; border-radius:5px; overflow: hidden;">
  <div style="text-align: center; font-weight:bold; background-color: #e6e6ff; padding: 1rem;">
    思考思考
  </div>
  <div style="padding: 1rem;">
    <ul>
<li>正则表达式<code>[^(ab)]</code>与<code>[^a^b]</code>有什么区别？</li>
<li><code>agrep(..., costs = 1, max = list(sub = 2, ins = 1, del = 3, cost = 2))</code>能够匹配的字符 <em>距离</em> 是多少？</li>
<li>修改字符串<strong>x</strong>的<strong>Encoding</strong>与对字符串进行转码（<strong>iconv</strong>）有什么区别？</li>
</ul>

  </div>
</div>

<p><br></p>
              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">标签</span><br/>
                    
  <a class="tag tag--primary tag--small" href="../../../tags/r%E8%AF%AD%E8%A8%80%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/">R语言数据类型</a>

                  </div>
                
              
            
            
<div id="gitmentContainer"></div>
<link rel="stylesheet" href="../../../css/gitment.css">
<script src="../../../js/gitment.js"></script>
<script>
    var gitment = new Gitment({
        id: 'R语言与字符串处理',
        owner: 'supernum163',
        repo: 'wly',
        oauth: {
            client_id: '40f2576aa2a372d81a1a',
            client_secret: 'c7f5edfb420146da2eed5a09576aaea56f402d30',
        },
    });
    gitment.render('gitmentContainer')
</script>

            <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="../../../2019/05/r%E8%AF%AD%E8%A8%80%E4%B8%AD%E7%9A%84%E6%95%B0%E5%80%BC/" data-tooltip="R语言中的数值">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="../../../2019/06/r%E8%AF%AD%E8%A8%80%E4%B8%8E%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4%E7%AE%A1%E7%90%86/" data-tooltip="R语言与日期时间管理">
              
                  <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default tooltip--top" target="new" href="http://service.weibo.com/share/share.php?title=title&amp;url=/2019/05/r%E8%AF%AD%E8%A8%80%E4%B8%8E%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%84%E7%90%86/&amp;source=bookmark#_loginLayer_1551323382531" data-tooltip="分享到 新浪微博">
              <i class="fa fa-weibo"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default tooltip--top" target="new" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=/2019/05/r%E8%AF%AD%E8%A8%80%E4%B8%8E%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%84%E7%90%86/" data-tooltip="分享到 QQ空间">
              <i class="fa fa-qq"></i>
            </a>
          </li>
        
        <li class="post-action hide-xs">
          <a class="post-action-btn btn btn--default tooltip--top show-url-btn-open" data-tooltip="分享到  微信" >
            <i class="fa fa-weixin"></i>
          </a>
        </li>
      
      <li class="post-action">
      
        <a class="post-action-btn btn btn--default tooltip--top" href="#gitmentContainer" data-tooltip="写下评论">
        <i class="fa fa-commenting-o"></i>
      
        </a>
      </li>
      <li class="post-action">
        <a class="post-action-btn btn btn--default tooltip--top" href="#" data-tooltip="回到顶部">
          <i class="fa fa-arrow-up"></i>
        </a>
      </li>
    </ul>
  
</div>

          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2020 <a href="https://github.com/supernum163">supernum</a>. 保留所有权
  </span>
</footer>

      </div>
      
        <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
          <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="../../../2019/05/r%E8%AF%AD%E8%A8%80%E4%B8%AD%E7%9A%84%E6%95%B0%E5%80%BC/" data-tooltip="R语言中的数值">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="../../../2019/06/r%E8%AF%AD%E8%A8%80%E4%B8%8E%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4%E7%AE%A1%E7%90%86/" data-tooltip="R语言与日期时间管理">
              
                  <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default tooltip--top" target="new" href="http://service.weibo.com/share/share.php?title=title&amp;url=/2019/05/r%E8%AF%AD%E8%A8%80%E4%B8%8E%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%84%E7%90%86/&amp;source=bookmark#_loginLayer_1551323382531" data-tooltip="分享到 新浪微博">
              <i class="fa fa-weibo"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default tooltip--top" target="new" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=/2019/05/r%E8%AF%AD%E8%A8%80%E4%B8%8E%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%84%E7%90%86/" data-tooltip="分享到 QQ空间">
              <i class="fa fa-qq"></i>
            </a>
          </li>
        
        <li class="post-action hide-xs">
          <a class="post-action-btn btn btn--default tooltip--top show-url-btn-open" data-tooltip="分享到  微信" >
            <i class="fa fa-weixin"></i>
          </a>
        </li>
      
      <li class="post-action">
      
        <a class="post-action-btn btn btn--default tooltip--top" href="#gitmentContainer" data-tooltip="写下评论">
        <i class="fa fa-commenting-o"></i>
      
        </a>
      </li>
      <li class="post-action">
        <a class="post-action-btn btn btn--default tooltip--top" href="#" data-tooltip="回到顶部">
          <i class="fa fa-arrow-up"></i>
        </a>
      </li>
    </ul>
  
</div>

        </div>
        
  <div id="share-options-bar" class="share-options-bar" data-behavior="4">
    <i id="btn-close-shareoptions" class="fa fa-close"></i>
    <ul class="share-options">
      
        <li class="share-option">
          <a class="share-option-btn" target="new" href="http://service.weibo.com/share/share.php?title=title&amp;url=%2F2019%2F05%2Fr%25E8%25AF%25AD%25E8%25A8%2580%25E4%25B8%258E%25E5%25AD%2597%25E7%25AC%25A6%25E4%25B8%25B2%25E5%25A4%2584%25E7%2590%2586%2F&amp;source=bookmark#_loginLayer_1551323382531">
            <i class="fa fa-weibo"></i><span>分享到 新浪微博</span>
          </a>
        </li>
      
        <li class="share-option">
          <a class="share-option-btn" target="new" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=%2F2019%2F05%2Fr%25E8%25AF%25AD%25E8%25A8%2580%25E4%25B8%258E%25E5%25AD%2597%25E7%25AC%25A6%25E4%25B8%25B2%25E5%25A4%2584%25E7%2590%2586%2F">
            <i class="fa fa-qq"></i><span>分享到 QQ空间</span>
          </a>
        </li>
      
        <li class="share-option">
          <a class="share-option-btn show-url-btn-open" href="#show-url-background">
            <i class="fa fa-weixin"></i><span>分享到  微信</span>
          </a>
        </li>
    </ul>
  </div>
  <div id="share-options-mask" class="share-options-mask"></div>

      
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    <img id="about-card-picture" src="https://s2.ax1x.com/2019/10/19/KmV65q.png" alt="作者的图片" />
    <h4 id="about-card-name">wly</h4>
    
      <div id="about-card-bio" style="margin: 0">仍是年少不知愁</div>
    
    
      <div id="about-card-bio">Still young. Still alive</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        数据分析师
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        中国 上海
      </div>
    
  </div>
</div>

    
    
  
    <div id="cover" style="background-color: #171314;"></div>
  


    
<script src="../../../js/jquery.min.js"></script>
<script src="../../../js/jquery.fancybox.min.js"></script>
<script src="../../../highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script src="../../../js/script-qi9wbxp2ya2j6p7wx1i6tgavftewndznf4v0hy2gvivk1rxgc3lm7njqb6bz.min.js"></script>











<script lang="javascript">
window.onload = updateMinWidth;
window.onresize = updateMinWidth;
document.getElementById("sidebar").addEventListener("transitionend", updateMinWidth);
function updateMinWidth() {
  var sidebar = document.getElementById("sidebar");
  var main = document.getElementById("main");
  main.style.minWidth = "";
  var w1 = getComputedStyle(main).getPropertyValue("min-width");
  var w2 = getComputedStyle(sidebar).getPropertyValue("width");
  var w3 = getComputedStyle(sidebar).getPropertyValue("left");
  main.style.minWidth = `calc(${w1} - ${w2} - ${w3})`;
}
</script>

    

  <style>
    #show-url-background {
      margin:0px;
      padding:0px;
      width:100%;
      height:100%;
      background-color:rgba(136,135,134,0.5);
      position:fixed;
      display:none;
      z-index:1000;
    }
    
    #show-url-card{
      text-align: center;
      position: relative; 
      top:50%; 
      left:50%;
      transform: translate(-50%, -50%);
      max-width:400px;
      max-height:400px;
      padding:5rem 0 3rem 0;
      background-color:#888786;
      display:none;
    }
    
    #show-url-describe{
      margin:2rem 0 0 0;
      color:white;
    }
  
    #show-url-btn-close {
      position: absolute; 
      top: 5px;
      right: 15px;
      color:white;
    }
  </style>

  <div id="show-url-background">
    <div id="show-url-card">
      <div id="show-url-btn-close">
        <i class="fa fa-remove"></i>
      </div>
      <div id="show-url-qrcode"></div> 
      <p id="show-url-describe">扫描上方二维码分享到微信</p>
    </div>
  </div>
  
  <script src="../../../js/qrcode.min.js"></script>

  <script type="text/javascript">
    new QRCode(document.getElementById("show-url-qrcode"), window.location.href);
    
    $(".show-url-btn-open").click(function(){
      $("#show-url-background").css("display", "block");
      $("#show-url-card").css("display", "block");
    }); 
    $("#show-url-btn-close").click(function(){
      $("#show-url-background").css("display", "none");
      $("#show-url-card").css("display", "none");
    }); 
  </script>
  

    
  </body>
</html>
